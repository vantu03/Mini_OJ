{% extends "judge/site_base.html" %}
{% block title %}Lịch sử nộp bài{% endblock %}

{% block content %}
<div class="container mt-4">
  <h3 class="mb-4">
    <i class="bi bi-clock-history me-2 text-primary"></i>
    Lịch sử nộp bài
  </h3>

  {% if submissions %}
    <div class="row gy-3">
      {% for sub in submissions %}
        <div class="col-12">
          <div class="card border-1 shadow-sm">
            <div class="card-body d-flex justify-content-start align-items-center gap-3">

              <!-- Badge trạng thái nằm bên trái -->
              <span class="badge px-3 py-2 rounded-pill fw-bold text-dark
                {% if sub.status == 'SUBMITTED' %}bg-success bg-opacity-25
                {% elif sub.status == 'COMPILE_ERROR' %}bg-secondary bg-opacity-25
                {% elif sub.status == 'SYSTEM_ERROR' %}bg-dark bg-opacity-25 text-light
                {% elif sub.status == 'PENDING' %}bg-light text-muted
                {% else %}bg-light text-muted
                {% endif %}
              ">
                {{ sub.status|slice:":3" }}
                <br>
                {{ sub.language.name }}
              </span>


              <!-- Thông tin bài nộp -->
              <div class="flex-grow-1">
                <h6 class="card-title mb-1"><a href="{% url 'problem' sub.problem.id %}">{{ sub.problem.title }}</a></h6>
                <p class="mb-1 text-muted small">
                  <strong>{{ sub.user.username }}</strong><br>
                  {{ sub.submitted_at|date:"H:i d/m/Y" }}
                </p>
              </div>

              {% if sub.user == request.user or request.user.is_superuser %}
                <!-- Nút xem -->
                <div>
                  <a href="{% url 'submission' sub.id %}">
                      Xem
                  </a>
                </div>
              {% endif %}

            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <p class="text-muted">Bạn chưa nộp bài nào.</p>
  {% endif %}
</div>
{% endblock %}
